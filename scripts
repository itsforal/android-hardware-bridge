#!/bin/bash

# Configuration
DEVICE_IP="192.168.1.174"
LOCAL_BIN_PATH="../bin/vhusbdarm"
REMOTE_PATH="/data/local/tmp/"

echo "--- Android Hardware Bridge Deployment ---"

# 1. Check if binary exists locally
if [ ! -f "$LOCAL_BIN_PATH" ]; then
    echo "❌ Error: Binary not found in bin/ folder."
    echo "Please place the ARM binary in the 'bin' directory first."
    exit 1
fi

# 2. Connect
echo "Connecting to device..."
adb connect $DEVICE_IP:5555

# 3. Push Binary
echo "Pushing binary to filesystem..."
adb push $LOCAL_BIN_PATH $REMOTE_PATH

# 4. Set Permissions
echo "Setting execution permissions (chmod 755)..."
adb shell chmod 755 ${REMOTE_PATH}vhusbdarm

echo "✅ Deployment Complete. You can now run the Python controller."